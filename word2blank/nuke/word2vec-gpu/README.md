
- Split `train()` into two parts: one that collects all gradients into a buffer, another part that updates
  all the gradients.
